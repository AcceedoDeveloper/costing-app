<div class="dashboard-grid">
  <div class="box customer-box">
     <div class="container">
        <div class="table-header">
          <div class="date-filters">
  <mat-form-field appearance="outline">
    <mat-label>Start Date</mat-label>
    <input matInput [matDatepicker]="estimationStartPicker" [(ngModel)]="estimationStartDate" (dateChange)="onEstimationDateChange()">
    <mat-datepicker-toggle matSuffix [for]="estimationStartPicker"></mat-datepicker-toggle>
    <mat-datepicker #estimationStartPicker></mat-datepicker>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>End Date</mat-label>
    <input matInput [matDatepicker]="estimationEndPicker" [(ngModel)]="estimationEndDate" (dateChange)="onEstimationDateChange()">
    <mat-datepicker-toggle matSuffix [for]="estimationEndPicker"></mat-datepicker-toggle>
    <mat-datepicker #estimationEndPicker></mat-datepicker>
  </mat-form-field>
</div>

            <h2>Customer List</h2>
           <input
        type="text"
        class="search-bar"
        placeholder="Search Customer"
        (input)="onSearch($event)"
      />
        </div>

        <div class="table-wrapper">

            <table >
  <thead>
    <tr>
      <th>Customer</th>
      <th>Part Name</th>
      <th>Total Process Cost</th>
      <th>Actual Cost</th>
      <th>Difference</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let item of filteredEstimationCost">
      <td>{{  item.CustomerName?.name }}</td>
      <td>{{ item.partName }}</td>
      <td>{{ item.TotalProcessCost }}</td>
      <td>{{ item.actualCost }}</td>
      <td [ngClass]="item.difference >= 0 ? 'positive' : 'negative'">
  <ng-container *ngIf="item.difference >= 0">
    <span class="arrow">↑</span> {{ item.difference | number:'1.0-0' }}
  </ng-container>
  <ng-container *ngIf="item.difference < 0">
    <span class="arrow">↓</span> {{ (item.difference * -1) | number:'1.0-1' }}
  </ng-container></td>
    </tr>
  </tbody>
</table>
        </div>
      
<div class="pagination-controls">
  <button (click)="prevPage()" [disabled]="currentPage === 1"><</button>
  <span>Page {{ currentPage }} of {{ totalPages }}</span>
  <button (click)="nextPage()" [disabled]="currentPage === totalPages">></button>
</div>
   
    </div>


  </div>

<div class="box quotation-box">
  <mat-tab-group animationDuration="500ms">

    <!-- Pending Quotation -->
    <mat-tab>
      <ng-template mat-tab-label>
        Pending Quotation <span class="tab-badge warning">{{ pendingQuotations.length }}</span>
      </ng-template>
      <div class="tab-display">
        <div class="quotation-card" *ngFor="let item of pendingQuotations">
          <div class="info-row">
            <p><strong>Customer Name:</strong> {{ item.CustomerName?.name }}</p>
            <p><strong>Part Name:</strong> {{ item.partName }}</p>
            <p><strong>Status:</strong> <span class="status warning">{{ item.Status }}</span></p>
          </div>
        </div>
      </div>
    </mat-tab>

    <!-- Completed Quotation -->
    <mat-tab>
      <ng-template mat-tab-label>
        Last Month Quotation <span class="tab-badge success">{{ completedQuotations.length }}</span>
      </ng-template>
      <div class="tab-display">
        <div class="quotation-card" *ngFor="let item of completedQuotations">
          <div class="info-row">
            <p><strong>Customer Name:</strong> {{ item.CustomerName?.name }}</p>
            <p><strong>Part Name:</strong> {{ item.partName }}</p>
            <p><strong>Status:</strong> <span class="status success">{{ item.Status }}</span></p>
          </div>
        </div>
      </div>
    </mat-tab>

  </mat-tab-group>
</div>



  <div class="box " *ngIf="chart">
   

    
  <google-chart
  [type]="chart.type"
  [data]="chart.data"
  [options]="chart.options"
  [width]="chart.width"
  [height]="chart.height">
</google-chart>

  </div>




  <div class="box fixed-height-box" >
     <div class="date-filters">
  <mat-form-field appearance="outline">
    <mat-label>Start Date</mat-label>
    <input matInput [matDatepicker]="startPicker" [(ngModel)]="startDate" (dateChange)="onDateChange()">
    <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
    <mat-datepicker #startPicker></mat-datepicker>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>End Date</mat-label>
    <input matInput [matDatepicker]="endPicker" [(ngModel)]="endDate" (dateChange)="onDateChange()">
    <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
    <mat-datepicker #endPicker></mat-datepicker>
  </mat-form-field>
</div>
    <!-- material-chart.component.html -->
<google-chart
  [type]="chartType"
  [data]="chartData"
  [options]="chartOptions"
  [width]="'100%'"
  [height]="'400px'">
</google-chart>

  </div>

<div class="box fixed-height-box">
    <h2>Recent Updates</h2>
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>User Name</th>
            <th>Message</th>
            <th>Updated At</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of recentUpdates">
            <td>{{ item.user.userName }}</td>
            <td>{{ item.message }}</td>
            <td>{{ item.updatedAt | date: 'short' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
 
</div>



