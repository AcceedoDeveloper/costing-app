<div class="user-management-update">
  <aside class="side-panel">
    <div class="panel-heading">
      <div class="icon-chip">
        <mat-icon>settings</mat-icon>
      </div>
      <div>
        <p class="eyebrow">User Management</p>
        <h2>Update</h2>
      </div>
    </div>


    <nav class="panel-nav">
      <div
        class="nav-chip"
        *ngFor="let link of quickLinks"
        [attr.data-anchor]="link.anchor"
        role="button"
        tabindex="0"
        (click)="scrollTo(link.anchor)"
        (keydown)="handleNavKey($event, link.anchor)">
        <span>{{ link.label }}</span>
        <mat-icon>chevron_right</mat-icon>
      </div>
    </nav>

  
  </aside>

  <section class="content">
    <header class="content-header">
      <div>
        <h1>Older vs New User Version</h1>
      </div>
      <div class="header-actions">
        <button mat-raised-button color="primary" (click)="openCreateVersionDialog()">
          <mat-icon>add</mat-icon>
          Create
        </button>
        <button mat-raised-button color="primary">
          <mat-icon>settings</mat-icon>
          Configure
        </button>
      </div>
    </header>

    <div class="versions-scroll">
      <div *ngIf="isLoading" class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading versions...</p>
      </div>
      <div class="versions-grid" *ngIf="!isLoading">
        <article
          class="version-card"
          *ngFor="let comparison of versionComparisons"
          [attr.id]="comparison.id">
          <div class="card-header">
            <div>
              <h3>{{ comparison.title }}</h3>
            </div>
            <div class="card-actions">
              <button
                mat-icon-button
                color="primary"
                (click)="openEditVersionDialog(comparison)"
                matTooltip="Edit version">
                <mat-icon>edit</mat-icon>
              </button>
              <button
                mat-icon-button
                color="warn"
                (click)="deleteVersion(comparison)"
                matTooltip="Delete version">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
      

          <div class="version-comparison">
            <section class="version older">
              <div class="version-label">
                <mat-icon>history</mat-icon>
                Older Version
              </div>
              <div
                class="version-image"
                [ngClass]="{ 'has-image': comparison.old.image }"
                [style.background-image]="getBackgroundImage(comparison.old.image)"
                [attr.tabindex]="comparison.old.image ? 0 : -1"
                [class.clickable]="comparison.old.image"
                (click)="openLightbox(comparison.old.image, comparison.old.caption)"
                (keydown)="handleImageKey($event, comparison.old.image, comparison.old.caption)">
                <ng-container *ngIf="!comparison.old.image">
                  <mat-icon>image</mat-icon>
                  <span>No image</span>
                </ng-container>
              </div>
              <!-- <p class="caption">{{ comparison.old.caption }}</p>
              <ul>
                <li *ngFor="let note of comparison.old.notes">{{ note }}</li>
              </ul> -->
            </section>

            <section class="version newer">
              <div class="version-label">
                <mat-icon>bolt</mat-icon>
                New Version
              </div>
              <div
                class="version-image"
                [ngClass]="{ 'has-image': comparison.newer.image }"
                [style.background-image]="getBackgroundImage(comparison.newer.image)"
                [attr.tabindex]="comparison.newer.image ? 0 : -1"
                [class.clickable]="comparison.newer.image"
                (click)="openLightbox(comparison.newer.image, comparison.newer.caption)"
                (keydown)="handleImageKey($event, comparison.newer.image, comparison.newer.caption)">
                <ng-container *ngIf="!comparison.newer.image">
                  <mat-icon>image</mat-icon>
                  <span>Drop image</span>
                </ng-container>
              </div>
              <!-- <p class="caption">{{ comparison.newer.caption }}</p>
              <ul>
                <li *ngFor="let note of comparison.newer.notes">{{ note }}</li>
              </ul>
              <div class="highlight-row">
                <span class="highlight" *ngFor="let highlight of comparison.newer.highlights">{{ highlight }}</span>
              </div> -->
            </section>
          </div>
        </article>
      </div>
    </div>
  </section>

  <div class="image-lightbox" *ngIf="lightboxImage" (click)="closeLightbox()">
    <div class="lightbox-content" (click)="$event.stopPropagation()">
      <button mat-icon-button class="close-btn" (click)="closeLightbox()">
        <mat-icon>close</mat-icon>
      </button>
      <img [src]="lightboxImage.url" [alt]="lightboxImage.title" />
      <p>{{ lightboxImage.title }}</p>
    </div>
  </div>
</div>

