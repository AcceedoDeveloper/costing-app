<div class="app-container">


  <!-- Main Content Area -->
  <div class="main-content">
    <div class="content-header">

  <div class="header-controls">

    <div class="filter-da" >

        <!-- First Filter Card: Customer, Drawing, Part Name Filters -->
    <div class="filter-card">
      <mat-form-field appearance="outline" class="filter-field" [class.active]="searchFilterType !== 'none'">
        <mat-label>Filter By:</mat-label>
        <mat-select [(ngModel)]="searchFilterType" (selectionChange)="onSearchFilterTypeChange()">
          <mat-option value="none">None</mat-option>
          <mat-option value="customerName">Customer Name</mat-option>
          <mat-option value="drawingNo">Drawing No</mat-option>
          <mat-option value="partNo">Part No</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline" class="filter-field" *ngIf="searchFilterType !== 'none'">
        <mat-label>{{ getSearchFilterLabel() }}:</mat-label>
        <mat-select [(ngModel)]="selectedSearchValue" (selectionChange)="onSearchValueChange()">
          <mat-option *ngFor="let option of searchFilterOptions" [value]="option">
            {{ option }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Second Filter Card: Date Filters -->
    <div class="filter-card">
      <mat-form-field appearance="outline" class="filter-field" [class.active]="dateFilterType !== 'none'">
        <mat-label>Date Filter By:</mat-label>
        <mat-select [(ngModel)]="dateFilterType" (selectionChange)="onFilterTypeChange()">
          <mat-option value="none">None</mat-option>
          <mat-option value="date">Date</mat-option>
          <mat-option value="week">Week</mat-option>
          <mat-option value="month">Month</mat-option>
          <mat-option value="year">Year</mat-option>
        </mat-select>
      </mat-form-field>

      <div class="filter-fields">

        <!-- Custom Date Picker -->
      <div class="filter-field" *ngIf="dateFilterType === 'date'">
        <label for="singleDate" class="input-label">Custom Date:</label>
        <input 
          type="date" 
          id="singleDate" 
          class="native-input"
          [(ngModel)]="filters.singleDate"
          (change)="onDateChange()">
      </div>

      <!-- Week Picker -->
      <div class="filter-field" *ngIf="dateFilterType === 'week'">
        <label for="weekFilter" class="input-label">Week:</label>
        <input 
          type="week" 
          id="weekFilter" 
          class="native-input"
          [(ngModel)]="filters.week"
          (change)="onWeekChange()">
      </div>

      <!-- Month Picker -->
      <div class="filter-field" *ngIf="dateFilterType === 'month'">
        <label for="monthFilter" class="input-label">Month:</label>
        <input 
          type="month" 
          id="monthFilter" 
          class="native-input"
          [(ngModel)]="filters.month"
          (change)="onMonthChange()">
      </div>

      <!-- Year Picker -->
      <div class="filter-field" *ngIf="dateFilterType === 'year'">
        <label for="yearFilter" class="input-label">Year:</label>
        <input 
          type="number" 
          id="yearFilter" 
          class="native-input"
          [(ngModel)]="filters.year"
          placeholder="YYYY"
          min="2000"
          max="2100"
          (change)="onYearChange()">
      </div>
      </div>
      
    </div>

     <!-- Add Quotation Button -->
     <div class="add-button-wrapper">
      <button mat-raised-button color="primary" class="add-but" (click)="addCustomerDetails()">
        Add Quotation
      </button>
    </div>
    </div>
  

   
  </div>
    </div>

    <div class="table-container">
      <table class="data-table">
    <thead>
      <tr>
            <th>ID</th>
        <th>Customer Name</th>
        <th>Drawing No</th>
        <th>Part No</th>
        <th>No of Process</th>
        <th>Overall Cost</th>
        <th>Download</th>
        <th>Action</th>
        <th>Updated At Time</th>
      </tr>
    </thead>
    <tbody>
          <ng-container *ngFor="let customer of filteredCustomers; let i = index">
            <tr>
              <td>{{ getFormattedId(customer, i) }}</td>
              <td>{{ customer.CustomerName?.name || '-' }}</td>
              <td>{{ customer.drawingNo || '-' }}</td>
              <td>{{ customer.partName || '-' }}</td>
              <td>{{ customer.processName?.length || 0 }} Process</td>
              <td>{{ customer.OverallTotalCost | number:'1.2-2' }}</td>
                <td class="download-cell">
                  <div class="combined-button">
                    <div class="view-section" (click)="viewQuotation(customer)">
                      <span>View</span>
                    </div>
                    <div class="download-section" (click)="downloadQuotation(customer)">
                      <span>Download</span>
                    </div>
                  </div>
      </td>
              <td >
                <button mat-icon-button  (click)="edit(customer._id)">
                  <mat-icon>edit</mat-icon>
        </button>
                <button mat-icon-button  (click)="delete(customer._id)">
                  <mat-icon>delete</mat-icon>
        </button>
      </td>
      <td>
        {{ customer.updatedAt ? (customer.updatedAt | date:'mediumDate') : (customer.createdAt ? (customer.createdAt | date:'mediumDate') : '-') }}
      </td>
      
    </tr>
  </ng-container>
</tbody>
      </table>
      
      <!-- Paginator -->
      <mat-paginator 
        [length]="totalRecords"
        [pageSize]="pageSize"
        [pageSizeOptions]="pageSizeOptions"
        [showFirstLastButtons]="true"
        (page)="onPageChange($event)"
        class="custom-paginator">
      </mat-paginator>
    </div>
  </div>
</div>
