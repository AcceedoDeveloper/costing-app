

    <div class="document-wrapper">
      <div class="document-page">
        <!-- Company Header Image -->
        <div class="company-header">
          <img src="assets/pdfheaderimage.png" alt="Indo Shell Cast Private Limited" class="header-image">
        </div>

        <!-- Quote Reference Section -->
        <div class="quote-reference-section">
          <div class="quote-ref-item">
            <span class="quote-label"
                  appPdfEdit
                  [quoteData]="quoteData"
                  propertyPath="header.quoteRefNumber.label"
                  [innerHTML]="boldBeforeColon(quoteData?.header.quoteRefNumber.label || '')"></span>
            <span class="quote-value"
                  appPdfEdit
                  [quoteData]="quoteData"
                  propertyPath="header.quoteRefNumber.value"
                  [innerHTML]="boldBeforeColon(quoteData?.header.quoteRefNumber.value || '-')">
            </span>
            &nbsp;&nbsp;
            <span class="quote-label">Date:</span>
            <span class="quote-value">{{ today }}/D</span>
          </div>

          <div class="quote-ref-item">
            <span class="quote-label"
                    appPdfEdit
                  [quoteData]="quoteData"
                  propertyPath="header.customer.label " >{{ quoteData?.header.customer.label }} -</span>
            <span class="quote-value"
                  appPdfEdit
                  [quoteData]="quoteData"
                  propertyPath="header.customer.value">
              {{ quoteData?.header.customer.value || '-' }}
            </span>
          </div>
        </div>

        <!-- Header Section -->
        <div class="document-header">
          <div class="attention-line">
            <span class="attention-label"
            appPdfEdit
                  [quoteData]="quoteData"
                  propertyPath="header.attention.label"
                  [innerHTML]="boldBeforeColon(quoteData?.header.attention.label || '')"></span>
            <span class="attention-value"
                  appPdfEdit
                  [quoteData]="quoteData"
                  propertyPath="header.attention.value"
                  [innerHTML]="boldBeforeColon(quoteData?.header.attention.value || '-')">
            </span>
          </div>

          <div class="greeting"
              appPdfEdit
              [quoteData]="quoteData"
              propertyPath="salutation"
              [innerHTML]="boldBeforeColon(quoteData?.salutation || '')">
          </div>

          <div class="intro-paragraph"
              appPdfEdit
              [quoteData]="quoteData"
              propertyPath="introduction"
              [innerHTML]="boldBeforeColon(quoteData?.introduction || '')">
          </div>
        </div>

        <!-- Main Quote Table -->
    <!-- Main Quote Table - NOW FULLY EDITABLE -->
    <div class="quote-table-section">
      <table class="main-quote-table">
        <thead>
          <tr>
            <th colspan="9" class="table-main-title"
                appPdfEdit
                [quoteData]="quoteData"
                propertyPath="quoteTable.title"
                [innerHTML]="boldBeforeColon(quoteData?.quoteTable.title || 'ISC - SHELL MOULDING/ STEEL CASTING - QUOTE')">
            </th>
          </tr>
          <tr>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].sno.label' : 'quoteTable.columns.sno'">
              {{ getColumnHeader('sno') || 'S.No' }}
            </th>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].drawingNumber.label' : 'quoteTable.columns.drawingNumber'">
              {{ getColumnHeader('drawingNumber') || 'Drawing No' }}
            </th>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].partName.label' : 'quoteTable.columns.partName'">
              {{ getColumnHeader('partName') || 'Part Name' }}
            </th>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].castingMaterial.label' : 'quoteTable.columns.castingMaterial'">
              {{ getColumnHeader('castingMaterial') || 'Casting Material' }}
            </th>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].castingWeightInKgs.label' : 'quoteTable.columns.castingWeightInKgs'">
              {{ getColumnHeader('castingWeightInKgs') || 'Casting Weight (kg)' }}
            </th>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].annualVolume.label' : 'quoteTable.columns.annualVolume'">
              {{ getColumnHeader('annualVolume') || 'Annual Volume' }}
            </th>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].partPriceInINR.label' : 'quoteTable.columns.partPriceInINR'">
              {{ getColumnHeader('partPriceInINR') || 'Part Price (INR)' }}
            </th>
            <th class="pattern-cost-header"
                appPdfEdit
                [quoteData]="quoteData"
                [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].patternCostINR.label' : 'quoteTable.columns.patternCostINR'">
              <div class="pattern-cost-title">{{ getColumnHeader('patternCostINR') || 'Pattern Cost (INR)' }}</div>
              <div class="pattern-cost-line"></div>
              <!-- <div class="pattern-cost-subtitle">(INR)</div> -->
            </th>
            <th appPdfEdit [quoteData]="quoteData" [propertyPath]="isColumnsArray() ? 'quoteTable.columns[0].moqInNos.label' : 'quoteTable.columns.moqInNos'">
              {{ getColumnHeader('moqInNos') || 'MOQ (Nos)' }}
            </th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngIf="quoteData?.quoteTable.parts && quoteData.quoteTable.parts.length > 0; else emptyTable">
            <ng-container *ngFor="let part of quoteData.quoteTable.parts; let i = index">
              <tr>
                <!-- S.No - usually not editable -->
                <td [attr.rowspan]="getRowSpan(i)" class="sno-cell">{{ i + 1 }}</td>

                <!-- Editable fields -->
                <td [attr.rowspan]="getRowSpan(i)" class="drawing-number-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].drawingNumber'">
                  {{ part.drawingNumber || '-' }}
                </td>

                <td [attr.rowspan]="getRowSpan(i)" class="part-name-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].partName'">
                  <div class="multi-line-text">{{ formatPartName(part.partName) || '-' }}</div>
                </td>

                <td [attr.rowspan]="getRowSpan(i)" class="material-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].castingMaterial'">
                  <div class="multi-line-text">{{ formatCastingMaterial(part.castingMaterial) || '-' }}</div>
                </td>

                <td [attr.rowspan]="getRowSpan(i)" class="data-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].castingWeight'">
                  {{ part.castingWeight || '-' }}
                </td>

                <td [attr.rowspan]="getRowSpan(i)" class="data-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].annualVolume'">
                  {{ part.annualVolume || '-' }}
                </td>

                <td [attr.rowspan]="getRowSpan(i)" class="data-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].partPrice'">
                  {{ part.partPrice || '-' }}
                </td>

                <td [attr.rowspan]="getRowSpan(i)" class="data-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].patternCost'">
                  {{ part.patternCost || '-' }}
                </td>

                <td [attr.rowspan]="getRowSpan(i)" class="data-cell"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'quoteTable.parts[' + i + '].moq'">
                  {{ part.moq || '-' }}
                </td>
              </tr>
              <!-- Empty rows for spacing if needed -->
              <tr *ngFor="let row of getEmptyRows(i)"></tr>
            </ng-container>
          </ng-container>

          <!-- Empty state -->
          <ng-template #emptyTable>
            <tr>
              <td class="sno-cell">1</td>
              <td class="drawing-number-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].drawingNumber">-</td>
              <td class="part-name-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].partName"><div class="multi-line-text">-</div></td>
              <td class="material-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].castingMaterial"><div class="multi-line-text">-</div></td>
              <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].castingWeight">-</td>
              <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].annualVolume">-</td>
              <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].partPrice">-</td>
              <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].patternCost">-</td>
              <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="quoteTable.parts[0].moq">-</td>
            </tr>
          </ng-template>
        </tbody>
      </table>
    </div>

        <!-- Chemical Composition -->
    <!-- Chemical Composition Section – NOW FULLY EDITABLE -->
    <div class="composition-section" (pdf-edit-action)="onPdfEditAction($event)">
      <!-- Section Title -->
      <div class="composition-intro"
          appPdfEdit
          [quoteData]="quoteData"
          propertyPath="rawMaterialComposition.title">
        {{ quoteData?.rawMaterialComposition.title || 'Chemical Composition' }}
      </div>

      <!-- Loop through each material (e.g. GS 20 Mn5, CA6NM, etc.) -->
      <ng-container *ngFor="let material of quoteData?.rawMaterialComposition.materials; let matIndex = index">
        <div class="composition-table-wrapper" style="margin-top: 20px; page-break-inside: avoid;">

          <table class="composition-table">
            <thead>
              <!-- Material Name Header (e.g. "GS 20 Mn5") -->
              <tr>
                <th [attr.colspan]="material.elements.length"
                    class="material-type-header"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'rawMaterialComposition.materials[' + matIndex + '].materialName'">
                  {{ material.materialName || 'Material Name' }}
                </th>
              </tr>

              <!-- Element Names Row (C, Mn, P, S, etc.) -->
              <tr>
                <th *ngFor="let el of material.elements; let elIndex = index"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'rawMaterialComposition.materials[' + matIndex + '].elements[' + elIndex + '].element'"
                    [innerHTML]="el.element ? boldBeforeColon(el.element) : '-'">
                </th>
              </tr>
            </thead>

            <tbody>
              <!-- Range Values Row -->
              <tr>
                <td class="data-cell"
                    *ngFor="let el of material.elements; let elIndex = index"
                    appPdfEdit
                    [quoteData]="quoteData"
                    [propertyPath]="'rawMaterialComposition.materials[' + matIndex + '].elements[' + elIndex + '].range'"
                    [innerHTML]="el.range ? boldBeforeColon(el.range) : '-'">
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </ng-container>

      <!-- Optional: Show empty table if no materials -->
      <ng-container *ngIf="!quoteData?.rawMaterialComposition.materials || quoteData.rawMaterialComposition.materials.length === 0">
        <div class="composition-table-wrapper" style="margin-top: 20px;">
          <table class="composition-table">
            <thead>
              <tr>
                <th colspan="8" class="material-type-header"
                    appPdfEdit
                    [quoteData]="quoteData"
                    propertyPath="rawMaterialComposition.materials[0].materialName">
                  Material Grade
                </th>
              </tr>
              <tr>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[0].element">C</th>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[1].element">Mn</th>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[2].element">P</th>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[3].element">S</th>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[4].element">Si</th>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[5].element">Cr</th>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[6].element">Ni</th>
                <th appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[7].element">Mo</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[0].range">-</td>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[1].range"> - </td>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[2].range">-</td>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[3].range">-</td>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[4].range">-</td>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[5].range">-</td>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[6].range">-</td>
                <td class="data-cell" appPdfEdit [quoteData]="quoteData" propertyPath="rawMaterialComposition.materials[0].elements[7].range">-</td>
              </tr>
            </tbody>
          </table>
        </div>
      </ng-container>
    </div>




<!-- GENERAL CONSIDERATIONS -->
<!-- GENERAL CONSIDERATIONS -->
<div class="considerations-section" (pdf-edit-action)="onPdfEditAction($event)">

  <!-- MAIN TITLE → Only Add new point -->
  <h3 class="section-title main-title"
      appPdfEdit
      [quoteData]="quoteData"
      propertyPath="generalConsiderations.title"
      [innerHTML]="quoteData?.generalConsiderations?.title?.trim() ? boldBeforeColon(quoteData.generalConsiderations.title) : '<em style=&quot;color:#999;&quot;>General Considerations</em>'">
  </h3>

  <ol class="considerations-list">
    <ng-container *ngFor="let item of quoteData?.generalConsiderations?.items || []; let i = index">
      <li class="consideration-item">

        <!-- TITLE LINE -->
        <div class="gc-title"
             appPdfEdit
             [quoteData]="quoteData"
             [propertyPath]="'generalConsiderations.items[' + i + '].title'"
             [innerHTML]="item.title?.trim() ? boldBeforeColon(item.title + ':') : '<em style=&quot;color:#aaa;&quot;>Click to add title...</em>:'">
        </div>

        <!-- DESCRIPTION LINE -->
           <div class="gc-description"
             appPdfEdit
             [quoteData]="quoteData"
             [propertyPath]="'generalConsiderations.items[' + i + '].description'"
             [innerHTML]="getDescriptionDisplay(item)">
           </div>

      </li>
    </ng-container>
  </ol>

</div>


<!-- COMMERCIAL TERMS & CONDITIONS -->
<div class="commercial-terms-section" (pdf-edit-action)="onPdfEditAction($event)">

 
<!-- MAIN TITLE → Add New Section -->
<h3 class="section-title main-title"
    appPdfEdit
    [quoteData]="quoteData"
    propertyPath="commercialTermsAndConditions.title"
    [innerHTML]="getMainTitleDisplay()">
</h3>

  <ol class="commercial-terms-list">
    <ng-container *ngFor="let section of quoteData?.commercialTermsAndConditions?.sections; let secIdx = index">
      <li class="main-term">

      
<!-- SECTION TITLE → Add point + Delete section -->
<div class="section-header">
  <div class="editable-title"
  appPdfEdit
  [quoteData]="quoteData"
  [propertyPath]="'commercialTermsAndConditions.sections[' + secIdx + '].sectionTitle'"
  [innerHTML]="getSectionTitleDisplay(section)">
</div>
</div>
        <div class="section-items">
          <ng-container *ngFor="let item of section.items; let itemIdx = index">


   <!-- Normal text line -->
<div *ngIf="item.text !== undefined && (!item.bulletPoints || item.bulletPoints.length === 0)"
class="text-line"
appPdfEdit
[quoteData]="quoteData"
[propertyPath]="'commercialTermsAndConditions.sections[' + secIdx + '].items[' + itemIdx + '].text'"
[innerHTML]="item.text ? boldBeforeColon(item.text) : '<em style=&quot;color:#aaa;&quot;>Click or press Add to type here...</em>'">
</div>

            <!-- Subheading (e.g. "HSN Codes as GST:") -->
            <div *ngIf="item.subheading"
                 class="subheading"
                 appPdfEdit
                 [quoteData]="quoteData"
                 [propertyPath]="'commercialTermsAndConditions.sections[' + secIdx + '].items[' + itemIdx + '].subheading'"
                 [innerHTML]="boldBeforeColon(item.subheading)">
            </div>

            <!-- BULLET POINTS BLOCK -->
            <div *ngIf="item.bulletPoints?.length" class="bullet-block">
              <ul class="bullet-list">
                <li *ngFor="let bullet of item.bulletPoints; let bIdx = index"
                class="bullet-item"
                appPdfEdit
                [quoteData]="quoteData"
                [propertyPath]="'commercialTermsAndConditions.sections[' + secIdx + '].items[' + itemIdx + '].bulletPoints[' + bIdx + ']'"
                [innerHTML]="bullet ? boldBeforeColon(bullet) : '<em style=&quot;color:#aaa;&quot;>New bullet point...</em>'">
            </li>
              </ul>
            </div>

          </ng-container>

        </div>
      </li>
    </ng-container>
  </ol>


</div>

    
        <!-- Closing Statement -->
        <div class="concluding-paragraph">
          <p appPdfEdit 
            [quoteData]="quoteData" 
            propertyPath="closingStatement"
            [innerHTML]="boldBeforeColon(quoteData?.closingStatement || '')">
          </p>
        </div>

        <!-- Signature -->
        <div class="signature-block">
          <div class="signature-line"
              appPdfEdit
              [quoteData]="quoteData"
              propertyPath="signature.thanks"
              [innerHTML]="boldBeforeColon(quoteData?.signature.thanks || '')">
          </div>
          <div class="signature-name"
              appPdfEdit
              [quoteData]="quoteData"
              propertyPath="signature.name"
              [innerHTML]="boldBeforeColon(quoteData?.signature.name || '')">
          </div>
          <div class="signature-title" 
              appPdfEdit 
              [quoteData]="quoteData" 
              propertyPath="signature.designation"
              [innerHTML]="boldBeforeColon(quoteData?.signature.designation || '')">
          </div>
          <div class="signature-department" 
              appPdfEdit 
              [quoteData]="quoteData" 
              propertyPath="signature.department"
              [innerHTML]="boldBeforeColon(quoteData?.signature.department || '')">
          </div>
       
        </div>

        <!-- Contact Footer -->
        <div class="contact-and-certification-section">
          <div class="contact-info">
            <div class="contact-text">
              <span
              class="contact-link"
              appPdfEdit
              [quoteData]="quoteData"
              propertyPath="contactInfo.address.value">
                  Address: {{ quoteData?.contactInfo.address.value }},
        
              </span>
          
              <span class="contact-link"
                    appPdfEdit
                    [quoteData]="quoteData"
                    propertyPath="contactInfo.phone.value">
                {{ quoteData?.contactInfo.phone.value || '-' }}
              </span>,<br>
              <span class="contact-link"
                    appPdfEdit
                    [quoteData]="quoteData"
                    propertyPath="contactInfo.website.value">
                {{ quoteData?.contactInfo.website.value || '-' }}
              </span>
            </div>
          </div>
          <div class="certification-logos">
            <img src="assets/pdffooter.png" alt="Certifications" class="certification-image">
          </div>
        </div>
      </div>
    </div>