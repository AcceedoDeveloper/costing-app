<div class="production-cost-container">
  <header class="page-header">
    <h1 class="page-title">Production Cost Settings</h1>
    <div class="section-navigation">
      <mat-form-field appearance="outline" class="section-select">
        <mat-label>Filter by Section</mat-label>
        <mat-select [(value)]="selectedSection">
          <mat-option value="">All Sections</mat-option>
          <mat-option value="power-cost">Power Cost</mat-option>
          <mat-option value="production-power">Production Power Details</mat-option>
          <mat-option value="moulding-input">Moulding Input</mat-option>
          <mat-option value="casting-input">Casting Input</mat-option>
          <mat-option value="salary-wages">Salary & Wages</mat-option>
          <mat-option value="overheads">Overheads</mat-option>
          <mat-option value="commercial-terms">Commercial Terms</mat-option>
          <mat-option value="profit-margin">Profit Margin</mat-option>
          <mat-option value="anticipated-rejection">Anticipated Rejection</mat-option>
          <mat-option value="core-input">Core Input</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </header>

  <div class="content-wrapper">
    <!-- POWER COST INPUT -->
    <ng-container *ngIf="selectedSection === '' || selectedSection === 'power-cost'">
      <div *ngFor="let item of powerCosts; let first = first" 
           class="section-wrapper" 
           [id]="first ? 'power-cost' : null">
      <mat-card class="cost-card power-cost-card">
        <div class="card-header">
          <h3 class="card-title">Power Cost</h3>
        </div>
        <div class="card-content">
          <div class="field-row">
            <div class="field-label">Cost Per Unit</div>
            <div class="field-value">
              <ng-container *ngIf="!editCostPerUnit; else editTemplate">
                <span class="value-text">{{ item.costPerUnit }}</span>
                <mat-icon class="edit-icon" (click)="enableEdit(item.costPerUnit)">edit</mat-icon>
              </ng-container>
              <ng-template #editTemplate>
                <div class="edit-controls">
                  <input class="edit-input" [(ngModel)]="editableCostPerUnit" type="number" />
                  <button mat-icon-button class="action-btn save-btn" (click)="saveCostPerUnit(item)">
                    <mat-icon>save</mat-icon>
                  </button>
                  <button mat-icon-button class="action-btn cancel-btn" (click)="cancelEditCostPerUnit()">
                    <mat-icon>cancel</mat-icon>
                  </button>
                </div>
              </ng-template>
            </div>
          </div>
          <div class="field-row">
            <div class="field-label">Effective Date</div>
            <div class="field-value">
              <span class="value-text">{{ item.effectiveDate }}</span>
            </div>
          </div>
          <div class="field-row">
            <div class="field-label">Previous Cost</div>
            <div class="field-value">
              <span class="value-text">{{ item.previousCostDetails[0]?.cost }}</span>
              <mat-icon class="info-icon" (click)="togglePopup(item._id, $event)">info</mat-icon>
            </div>
          </div>
        </div>
      </mat-card>
      <!-- Popup moved outside mat-card but inside *ngFor for proper centering -->
      <div *ngIf="activePopupId === item._id" class="popup-overlay" (click)="closePopup()">
        <div class="popup-content" (click)="$event.stopPropagation()">
          <div class="popup-header">
            <h4>Previous Cost History</h4>
            <mat-icon class="close-icon" (click)="closePopup()">close</mat-icon>
          </div>
          <div class="popup-body">
            <div *ngFor="let detail of item.previousCostDetails" class="history-item">
              <span class="history-cost">Cost: {{ detail.cost }}</span>
              <span class="history-date">Date: {{ detail.date }}</span>
            </div>
          </div>
        </div>
      </div>
      </div>
    </ng-container>

       <!-- PRODUCTION POWER -->
       <div *ngIf="productionPower && (selectedSection === '' || selectedSection === 'production-power')" 
            class="section-wrapper" 
            id="production-power">
        <mat-card class="cost-card power-card">
          <div class="card-header">
            <h3 class="card-title">Production Power Details</h3>
            <mat-icon class="edit-icon header-edit" (click)="enablePowerEdit()">edit</mat-icon>
          </div>
          <div class="card-content">
            <!-- Edit Mode -->
            <ng-container *ngIf="editMode['power']; else viewPower">
              <div class="field-row">
                <div class="field-label">Melt & Others Power</div>
                <div class="field-value">
                  <input class="edit-input" type="number" [(ngModel)]="editablePower.MeltAndOthersPower" />
                </div>
              </div>
              <div class="field-row">
                <div class="field-label">Mould Power</div>
                <div class="field-value">
                  <input class="edit-input" type="number" [(ngModel)]="editablePower.mouldPower" />
                </div>
              </div>
              <div class="field-row">
                <div class="field-label">Core Power</div>
                <div class="field-value">
                  <input class="edit-input" type="number" [(ngModel)]="editablePower.corePower" />
                </div>
              </div>
              <div class="action-buttons">
                <button class="save-button" (click)="savePower()">Save</button>
                <button class="cancel-button" (click)="cancelPowerEdit()">Cancel</button>
              </div>
            </ng-container>
  
            <!-- View Mode -->
            <ng-template #viewPower>
              <div class="field-row">
                <div class="field-label">Melt & Others Power</div>
                <div class="field-value">
                  <span class="value-text">{{ productionPower.MeltAndOthersPower }}</span>
                </div>
              </div>
              <div class="field-row">
                <div class="field-label">Mould Power</div>
                <div class="field-value">
                  <span class="value-text">{{ productionPower.mouldPower }}</span>
                </div>
              </div>
              <div class="field-row">
                <div class="field-label">Core Power</div>
                <div class="field-value">
                  <span class="value-text">{{ productionPower.corePower }}</span>
                </div>
              </div>
            </ng-template>
          </div>
        </mat-card>
      </div>

     <!-- MOULDING INPUT -->
     <ng-container *ngIf="selectedSection === '' || selectedSection === 'moulding-input'">
       <div *ngFor="let item of castingData; let first = first" 
            class="section-wrapper" 
            [id]="first ? 'moulding-input' : null">
      <mat-card class="cost-card moulding-card">
        <div class="card-header">
          <h3 class="card-title">Moulding Input</h3>
          <mat-icon class="edit-icon header-edit" (click)="enableEditMode('moulding', item)">edit</mat-icon>
        </div>
        <div class="card-content">
          <ng-container *ngIf="editMode['moulding'] && editableItem?._id === item._id; else viewMoulding">
            <div class="field-row">
              <div class="field-label">Moulding Weight</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.MouldingInput.MouldingWeight" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Moulds Per Heat</div>
              <div class="field-value">
                <span class="value-text">{{ editableItem.MouldingInput.MouldsPerHeat }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Bake Moulding</div>
              <div class="field-value">
                <span class="value-text">{{ editableItem.MouldingInput.BakeMoulding }}</span>
              </div>
            </div>
            <div class="action-buttons">
              <button class="save-button" (click)="saveAllCastingChanges()">Save</button>
              <button class="cancel-button" (click)="cancelEditMode('moulding')">Cancel</button>
            </div>
          </ng-container>

          <ng-template #viewMoulding>
            <div class="field-row">
              <div class="field-label">Moulding Weight</div>
              <div class="field-value">
                <span class="value-text">{{ item.MouldingInput.MouldingWeight }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Moulds Per Heat</div>
              <div class="field-value">
                <span class="value-text">{{ item.MouldingInput.MouldsPerHeat }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Bake Moulding</div>
              <div class="field-value">
                <span class="value-text">{{ item.MouldingInput.BakeMoulding }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
      </div>
    </ng-container>
    
    <!-- CASTING INPUT -->
    <ng-container *ngIf="selectedSection === '' || selectedSection === 'casting-input'">
      <div *ngFor="let item of castingData; let first = first" 
           class="section-wrapper" 
           [id]="first ? 'casting-input' : null">
      <mat-card class="cost-card casting-card">
        <div class="card-header">
          <h3 class="card-title">Casting Input</h3>
          <mat-icon class="edit-icon header-edit" (click)="enableEditMode('casting', item)">edit</mat-icon>
        </div>
        <div class="card-content">
          <ng-container *ngIf="editMode['casting'] && editableItem?._id === item._id; else viewCasting">
            <div class="field-row">
              <div class="field-label">Casting Weight</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.CastingInput.CastingWeight" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Cavities</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.CastingInput.Cavities" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Pouring Weight</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.CastingInput.PouringWeight" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Weight/Heat</div>
              <div class="field-value">
                <span class="value-text">{{ editableItem.CastingInput.CastingWeightKgPerHeat }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Material Returned</div>
              <div class="field-value">
                <span class="value-text">{{ editableItem.CastingInput.MaterialReturned }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Yield</div>
              <div class="field-value">
                <span class="value-text">{{ editableItem.CastingInput.Yeild }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Yield %</div>
              <div class="field-value">
                <span class="value-text">{{ editableItem.CastingInput.YeildPercent }}</span>
              </div>
            </div>
            <div class="action-buttons">
              <button class="save-button" (click)="saveAllCastingChanges()">Save</button>
              <button class="cancel-button" (click)="cancelEditMode('casting')">Cancel</button>
            </div>
          </ng-container>

          <ng-template #viewCasting>
            <div class="field-row">
              <div class="field-label">Casting Weight</div>
              <div class="field-value">
                <span class="value-text">{{ item.CastingInput.CastingWeight }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Cavities</div>
              <div class="field-value">
                <span class="value-text">{{ item.CastingInput.Cavities }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Pouring Weight</div>
              <div class="field-value">
                <span class="value-text">{{ item.CastingInput.PouringWeight }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Weight/Heat</div>
              <div class="field-value">
                <span class="value-text">{{ item.CastingInput.CastingWeightKgPerHeat }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Material Returned</div>
              <div class="field-value">
                <span class="value-text">{{ item.CastingInput.MaterialReturned }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Yield</div>
              <div class="field-value">
                <span class="value-text">{{ item.CastingInput.Yeild }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Yield %</div>
              <div class="field-value">
                <span class="value-text">{{ item.CastingInput.YeildPercent }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
      </div>
    </ng-container>


   


   




    <!-- SALARY AND WAGES -->
    <ng-container *ngIf="selectedSection === '' || selectedSection === 'salary-wages'">
      <div *ngFor="let item of costsummary; let first = first" 
           class="section-wrapper" 
           [id]="first ? 'salary-wages' : null">
      <mat-card class="cost-card salary-card">
        <div class="card-header">
          <h3 class="card-title">Salary & Wages</h3>
          <mat-icon class="edit-icon header-edit" (click)="enableEditMode('salary', item)">edit</mat-icon>
        </div>
        <div class="card-content">
          <!-- Edit Mode -->
          <ng-container *ngIf="editMode['salary'] && editableItem?._id === item._id; else viewSalary">
            <div class="field-row">
              <div class="field-label">Salary for Process</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.SalaryAndWages.salaryforProcess" (ngModelChange)="calculateSalary()" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Excluding Core Making</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.SalaryAndWages.salaryExcludingCoreMaking" (ngModelChange)="calculateSalary()" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Core Production</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.SalaryAndWages.salaryForCoreProduction" (ngModelChange)="calculateSalary()" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Outsourcing Cost</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.SalaryAndWages.outSourcingCost" (ngModelChange)="calculateSalary()" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Special Outsourcing</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.SalaryAndWages.splOutSourcingCost" (ngModelChange)="calculateSalary()" />
              </div>
            </div>
            <div class="field-row highlight-row">
              <div class="field-label">Total Outsourcing</div>
              <div class="field-value">
                <span class="value-text highlight-value">{{ editableItem.SalaryAndWages.TotalOutSourcingCost }}</span>
              </div>
            </div>
            <div class="action-buttons">
              <button class="save-button" (click)="saveSlaray('salary')">Save</button>
              <button class="cancel-button" (click)="cancelEditMode('salary')">Cancel</button>
            </div>
          </ng-container>

          <!-- View Mode -->
          <ng-template #viewSalary>
            <div class="field-row">
              <div class="field-label">Salary for Process</div>
              <div class="field-value">
                <span class="value-text">{{ item.SalaryAndWages.salaryforProcess }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Excluding Core Making</div>
              <div class="field-value">
                <span class="value-text">{{ item.SalaryAndWages.salaryExcludingCoreMaking }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Core Production</div>
              <div class="field-value">
                <span class="value-text">{{ item.SalaryAndWages.salaryForCoreProduction }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Outsourcing Cost</div>
              <div class="field-value">
                <span class="value-text">{{ item.SalaryAndWages.outSourcingCost }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Special Outsourcing</div>
              <div class="field-value">
                <span class="value-text">{{ item.SalaryAndWages.splOutSourcingCost }}</span>
              </div>
            </div>
            <div class="field-row highlight-row">
              <div class="field-label">Total Outsourcing</div>
              <div class="field-value">
                <span class="value-text highlight-value">{{ item.SalaryAndWages.TotalOutSourcingCost }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
      </div>
    </ng-container>


    <!-- OVERHEADS -->
    <ng-container *ngIf="selectedSection === '' || selectedSection === 'overheads'">
      <div *ngFor="let item of costsummary; let first = first" 
           class="section-wrapper" 
           [id]="first ? 'overheads' : null">
      <mat-card class="cost-card overhead-card">
        <div class="card-header">
          <h3 class="card-title">Overheads</h3>
          <mat-icon class="edit-icon header-edit" (click)="enableEditMode('overhead', item)">edit</mat-icon>
        </div>
        <div class="card-content">
          <!-- Edit Mode -->
          <ng-container *ngIf="editMode['overhead'] && editableItem?._id === item._id; else viewOverhead">
            <div class="field-row">
              <div class="field-label">Repair & Maintenance</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.OverHeads.repairAndMaintenance" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Selling & Misc</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.OverHeads.sellingDistributionAndMiscOverHeads" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Finance Cost</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.OverHeads.financeCost" />
              </div>
            </div>
            <div class="field-row highlight-row">
              <div class="field-label">Total Overheads</div>
              <div class="field-value">
                <span class="value-text highlight-value">{{ editableItem.OverHeads.totalOverHeads }}</span>
              </div>
            </div>
            <div class="field-row highlight-row">
              <div class="field-label">Total with Finance</div>
              <div class="field-value">
                <span class="value-text highlight-value">{{ editableItem.OverHeads.totalOverHeadsWithFinanceCost }}</span>
              </div>
            </div>
            <div class="action-buttons">
              <button class="save-button" (click)="saveOverHeads('overhead')">Save</button>
              <button class="cancel-button" (click)="cancelEditMode('overhead')">Cancel</button>
            </div>
          </ng-container>

          <!-- View Mode -->
          <ng-template #viewOverhead>
            <div class="field-row">
              <div class="field-label">Repair & Maintenance</div>
              <div class="field-value">
                <span class="value-text">{{ item.OverHeads.repairAndMaintenance }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Selling & Misc</div>
              <div class="field-value">
                <span class="value-text">{{ item.OverHeads.sellingDistributionAndMiscOverHeads }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Finance Cost</div>
              <div class="field-value">
                <span class="value-text">{{ item.OverHeads.financeCost }}</span>
              </div>
            </div>
            <div class="field-row highlight-row">
              <div class="field-label">Total Overheads</div>
              <div class="field-value">
                <span class="value-text highlight-value">{{ item.OverHeads.totalOverHeads }}</span>
              </div>
            </div>
            <div class="field-row highlight-row">
              <div class="field-label">Total with Finance</div>
              <div class="field-value">
                <span class="value-text highlight-value">{{ item.OverHeads.totalOverHeadsWithFinanceCost }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
      </div>
    </ng-container>

   


    <!-- COMMERCIAL TERMS -->
    <ng-container *ngIf="selectedSection === '' || selectedSection === 'commercial-terms'">
      <div *ngFor="let item of costsummary; let first = first" 
           class="section-wrapper" 
           [id]="first ? 'commercial-terms' : null">
      <mat-card class="cost-card terms-card">
        <div class="card-header">
          <h3 class="card-title">Commercial Terms</h3>
          <mat-icon class="edit-icon header-edit" (click)="enableEditMode('terms', item)">edit</mat-icon>
        </div>
        <div class="card-content">
          <!-- Edit Mode -->
          <ng-container *ngIf="editMode['terms'] && editableItem?._id === item._id; else viewTerms">
            <div class="field-row">
              <div class="field-label">Payment Credit Period</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.CommercialTerms.paymentCreditPeriod" />
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Bank Interest</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.CommercialTerms.bankInterest" />
              </div>
            </div>
            <div class="action-buttons">
              <button class="save-button" (click)="saveChanges('terms')">Save</button>
              <button class="cancel-button" (click)="cancelEditMode('terms')">Cancel</button>
            </div>
          </ng-container>

          <!-- View Mode -->
          <ng-template #viewTerms>
            <div class="field-row">
              <div class="field-label">Payment Credit Period</div>
              <div class="field-value">
                <span class="value-text">{{ item.CommercialTerms?.paymentCreditPeriod }}</span>
              </div>
            </div>
            <div class="field-row">
              <div class="field-label">Bank Interest</div>
              <div class="field-value">
                <span class="value-text">{{ item.CommercialTerms?.bankInterest }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
      </div>
    </ng-container>



    <!-- PROFIT MARGIN -->
    <ng-container *ngIf="selectedSection === '' || selectedSection === 'profit-margin'">
      <div *ngFor="let item of costsummary; let first = first" 
           class="section-wrapper" 
           [id]="first ? 'profit-margin' : null">
      <mat-card class="cost-card margin-card">
        <div class="card-header">
          <h3 class="card-title">Profit Margin</h3>
          <mat-icon class="edit-icon header-edit" (click)="enableEditMode('margin', item)">edit</mat-icon>
        </div>
        <div class="card-content">
          <!-- Edit Mode -->
          <ng-container *ngIf="editMode['margin'] && editableItem?._id === item._id; else viewMargin">
            <div class="field-row">
              <div class="field-label">Profit %</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.Margin.profit" />
              </div>
            </div>
            <div class="action-buttons">
              <button class="save-button" (click)="saveChanges('margin')">Save</button>
              <button class="cancel-button" (click)="cancelEditMode('margin')">Cancel</button>
            </div>
          </ng-container>

          <!-- View Mode -->
          <ng-template #viewMargin>
            <div class="field-row">
              <div class="field-label">Profit %</div>
              <div class="field-value">
                <span class="value-text">{{ item.Margin?.profit }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
      </div>
    </ng-container>



    <!-- ANTICIPATED REJECTION -->
    <ng-container *ngIf="selectedSection === '' || selectedSection === 'anticipated-rejection'">
      <div *ngFor="let item of costsummary; let first = first" 
           class="section-wrapper" 
           [id]="first ? 'anticipated-rejection' : null">
      <mat-card class="cost-card rejection-card">
        <div class="card-header">
          <h3 class="card-title">Anticipated Rejection</h3>
          <mat-icon class="edit-icon header-edit" (click)="enableEditMode('rejection', item)">edit</mat-icon>
        </div>
        <div class="card-content">
          <!-- Edit Mode -->
          <ng-container *ngIf="editMode['rejection'] && editableItem?._id === item._id; else viewRejection">
            <div class="field-row">
              <div class="field-label">Rejection %</div>
              <div class="field-value">
                <input class="edit-input" type="number" [(ngModel)]="editableItem.AnticipatedRejection.rejection" />
              </div>
            </div>
            <div class="action-buttons">
              <button class="save-button" (click)="saveChanges('rejection')">Save</button>
              <button class="cancel-button" (click)="cancelEditMode('rejection')">Cancel</button>
            </div>
          </ng-container>

          <!-- View Mode -->
          <ng-template #viewRejection>
            <div class="field-row">
              <div class="field-label">Rejection %</div>
              <div class="field-value">
                <span class="value-text">{{ item.AnticipatedRejection?.rejection }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </mat-card>
      </div>
    </ng-container>



 <!-- CORE INPUT -->
 <ng-container *ngIf="selectedSection === '' || selectedSection === 'core-input'">
   <div *ngFor="let item of castingData; let first = first" 
        class="section-wrapper" 
        [id]="first ? 'core-input' : null">
  <mat-card class="cost-card core-card">
    <div class="card-header">
      <h3 class="card-title">Core Input</h3>
      <mat-icon class="edit-icon header-edit" (click)="enableEditMode('core', item)">edit</mat-icon>
    </div>
    <div class="card-content">
      <ng-container *ngIf="editMode['core'] && editableItem?._id === item._id; else viewCore">
        <div class="field-row">
          <div class="field-label">Core Weight</div>
          <div class="field-value">
            <input class="edit-input" type="number" [(ngModel)]="editableItem.CoreInput.CoreWeight" />
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Cores Per Mould</div>
          <div class="field-value">
            <input class="edit-input" type="number" [(ngModel)]="editableItem.CoreInput.CoresPerMould" />
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Core Cavities</div>
          <div class="field-value">
            <input class="edit-input" type="number" [(ngModel)]="editableItem.CoreInput.CoreCavities" />
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Shooting/Shift</div>
          <div class="field-value">
            <input class="edit-input" type="number" [(ngModel)]="editableItem.CoreInput.ShootingPerShift" />
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Core Sand</div>
          <div class="field-value">
            <input class="edit-input" type="number" [(ngModel)]="editableItem.CoreInput.CoreSand" />
          </div>
        </div>
        <div class="action-buttons">
          <button class="save-button" (click)="saveAllCastingChanges()">Save</button>
          <button class="cancel-button" (click)="cancelEditMode('core')">Cancel</button>
        </div>
      </ng-container>

      <ng-template #viewCore>
        <div class="field-row">
          <div class="field-label">Core Weight</div>
          <div class="field-value">
            <span class="value-text">{{ item.CoreInput.CoreWeight }}</span>
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Cores Per Mould</div>
          <div class="field-value">
            <span class="value-text">{{ item.CoreInput.CoresPerMould }}</span>
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Core Cavities</div>
          <div class="field-value">
            <span class="value-text">{{ item.CoreInput.CoreCavities }}</span>
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Shooting/Shift</div>
          <div class="field-value">
            <span class="value-text">{{ item.CoreInput.ShootingPerShift }}</span>
          </div>
        </div>
        <div class="field-row">
          <div class="field-label">Core Sand</div>
          <div class="field-value">
            <span class="value-text">{{ item.CoreInput.CoreSand }}</span>
          </div>
        </div>
      </ng-template>
    </div>
  </mat-card>
  </div>
</ng-container>


 

  </div>
</div>